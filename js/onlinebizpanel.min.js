var onlineBizPanel=function(e,n){function d(){a.toggleClass("ob-expanded ob-collapse"),t.toggleClass("ob-fadeOut ob-fadeIn"),o.find("i").toggleClass("rotate-up")}function u(e){e.outerHeight()}function c(e,n){var o=e?t:i;o.addClass("ob-hide"),o.toggleClass("ob-fadeOut ob-fadeIn"),n.removeClass("ob-hide"),u(n),n.toggleClass("ob-fadeOut ob-fadeIn"),e||p.set(a[0])}function f(e){d()}function b(n){c(!1,t),s.addClass("ob-hide"),e(".bottom-wrap, .top-wrap").remove()}function g(n){n.preventDefault();var a=e(this).attr("data-businessname"),t=ajaxManager.search("businessName",a),o=c.bind(null,!0,i);s.removeClass("ob-hide"),C(t,o)}function m(e){var n=e.target,a=n.scrollTop,t=n.scrollHeight-n.clientHeight;a>=6&&r&&(o.addClass("drop-shadow"),r=!1),5>=a&&(o.removeClass("drop-shadow"),r=!0),p.update(a),a===t&&ajaxManager.loadMore(10,x)}function h(e){p.save()}function v(e,a){var t=n.createElement(e);return a&&Object.keys(a).forEach(function(e){t.setAttribute(e,a[e])}),t}function C(a,t){var o,s=n.createDocumentFragment(),l=a.phone,r=a.website,p=a.businessName,d=a.details,u=a.logo,c=a.mainimage,f=v("div",{"class":"top-wrap clearfix"}),b=v("div",{"class":"bottom-wrap"}),g=v("h2"),m=v("a",{"class":"ob-phone",href:"tel:"+k(l)}),h=v("a",{href:r,target:"_blank"}),C=v("p"),w=v("hr"),x=u?v("img",{src:u,alt:p}):void 0,D=c?v("img",{src:c,alt:p}):void 0;x?e(f).append(x):x,e(f).append(g),e(f).append(m),e(g).append(p),e(m).append(k(l)),e(s).append(f),e(b).append(C),e(b).append(h),D?e(b).append(w,D):D,e(C).append(d),e(h).append(r),e(s).append(b),i.append(s),o=x?x:D,o?e(o).load(t):t()}function w(e,n){return e.length>n?e.slice(0,n-3)+"...":e}function k(e){var n=e.replace(/[\D]/gi,""),a=n.replace(/(\d{3})+(\d{3})+(\d{4})/gi,"$1-$2-$3");return a}function x(a){var o=n.createDocumentFragment();a.forEach(function(n){var a=n.phone,t=n.website,i=n.businessName,s=n.details,l=v("li",{"class":"ob-fadeOut"}),r=v("a",{"class":"ob-details",href:"#","data-businessname":i}),p=v("p"),d=v("div",{"class":"ob-phone"}),u=v("a",{href:t,target:"_blank"}),c=v("h2"),f=w(s,73);e(l).append(r,d,u),e(c).append(i),e(p).append(f),e(r).append(c,p),e(d).append(k(a)),e(u).append(t),e(o).append(l)}),t.append(o),u(t),t.children("li").removeAttr("class")}function D(){a.hasClass("ob-expanded")&&d()}function j(){a.hasClass("ob-collapse")&&d()}function N(n){a=e(n.listContainer),t=e(n.listInnerContainer),o=e(n.toggleElement),i=e(n.fullDetails),s=e(n.backButton),ajaxManager.loadData(x),o.bind("click",f),t.on("click",'a[class^="ob-details"]',g),a.on("scroll",m),s.bind("click",b),t.on("mousedown",h.bind(p))}var a,t,o,i,s,l,r=!0,p={top:[],temp:null,update:function(e){this.temp=e},save:function(){this.top.push(this.temp)},set:function(e){e.scrollTop=this.top[0],this.top.pop()}};return l={init:N,expand:j,collapse:D,buildList:x}}(jQuery,document);$(document).ready(function(){onlineBizPanel.init({listContainer:"#online-list-containter",listInnerContainer:"#online-list-containter ul",toggleElement:"#online-biz-toggle",fullDetails:"#ob-full-details",backButton:"#back-button"}),$("#loadbutton").bind("click",function(e){e.preventDefault(),ajaxManager.loadMore(10,onlineBizPanel.buildList)})});